<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="css/app.css">
  <script src="https://unpkg.com/vue@2"></script>
</head>

<body>
  <div id="app">
    <header>
      <!-- <h1>{{sitename}}</h1> -->
      <h1 v-text="sitename"></h1>
    </header>
    <main>
      <div class="row product">
        <div class="col">
          <figure>
            <img v-bind:src="product.image" alt="cat" style="width: 100px;">
          </figure>
        </div>
        <div class="col col-expand">
          <h1 v-text="product.title"></h1>
          <p v-html="product.description"></p>
          <p>{{product.price | formatPrice}}</p>
        </div>
      </div>
    </main>
  </div>
  <script>
    var APP_LOG_LIFECYCLE_EVENT = false;
    let store = new Vue({
      el: '#app', //vue만들어서 보여줄 위치 
      data: {
        sitename: 'Vue.js 애완용품 샵',
        product: {
          id: 1001,
          title: '고양이 사료, 25파운드',
          description: "당신의 고양이를 위한<em><strong>거부할 수 없는</strong></em>," + "유기농 25파운드 사료입니다.",
          price: 20000000000000,
          image: 'images/product-fullsize.png'
        }
      },
      filters: {
        formatPrice: function(price){
          //99999: 999.99  2000.00 -> 2,000.00
          if(!parseInt(price)){return "";}
          if(price>99999){
            var priceString = (price/100).toFixed(2);//소수로 변환
            console.log(priceString);
            var priceArray = priceString.split("").reverse();//역으로 출력
            console.log(priceArray);
            var index = 3;
            while(priceArray.length > index+3){
             priceArray.splice(index + 3,0,","); // 3자리 마다 ','추가하겠단 의미 
             index += 4; 
            }
            return "$" + priceArray.reverse().join(""); //형식에 맞게 반환
          }else {
            return "$" + (price/100).toFixed(2); //1000미만일때 값 반환
          }
        }
      },
      brforeCreate: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('beforeCreate hook')
        }
      },
      created: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('Created hook')
        }
        fetch('data.json')
          .then(resolve => resolve.json())
          .then(result => {
            store.sitename = result.sitename
          })
          .catch(err => console.log);
      },
      beforeMount: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('beforeMount hook')
        }
      },
      mounted: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('mounted hook')
        }
      },
      beforeUpdate: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('beforeUpdate hook')
        }
      },
      updated: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('updated hook')
          //alert('updated')
        }
      },
      beforeDestroy: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('beforeDestroy hook')
        }
      },
      destroyed: function () {
        if (APP_LOG_LIFECYCLE_EVENT) {
          console.log('destroyed hook')
        }
      }
    });
  </script>

</body>

</html>